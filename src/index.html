<!DOCTYPE html>
<html lang="en" class="reveal-full-page">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mono-Poly</title>
    <link rel="stylesheet" href="npm:reveal.js/dist/reset.css" />
    <link rel="stylesheet" href="npm:reveal.js/dist/reveal.css" />
    <link rel="stylesheet" href="npm:bootstrap/dist/css/bootstrap-grid.css" />
    <link rel="stylesheet" href="npm:bootstrap/dist/css/bootstrap-utilities.css" />

    <!-- <link rel="stylesheet" href="npm:reveal.js/dist/theme/black.css" /> -->
    <!-- <link rel="stylesheet" href="npm:reveal.js/dist/theme/white.css" /> -->
    <!-- <link rel="stylesheet" href="npm:reveal.js/dist/theme/league.css" /> -->
    <!-- <link rel="stylesheet" href="npm:reveal.js/dist/theme/beige.css" /> -->
    <!-- <link rel="stylesheet" href="npm:reveal.js/dist/theme/sky.css" /> -->
    <!-- <link rel="stylesheet" href="npm:reveal.js/dist/theme/night.css" /> -->
    <!-- <link rel="stylesheet" href="npm:reveal.js/dist/theme/serif.css" /> -->
    <!-- <link rel="stylesheet" href="npm:reveal.js/dist/theme/simple.css" /> -->
    <!-- <link rel="stylesheet" href="npm:reveal.js/dist/theme/solarized.css" /> -->
    <link rel="stylesheet" href="npm:reveal.js/dist/theme/blood.css" />
    <!-- <link rel="stylesheet" href="npm:reveal.js/dist/theme/moon.css" /> -->
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section data-background-color="white">
          <small
            >Vortrag
            <a href="https://www.meetup.com/de-DE/kasselcodemeetup/events/285387139/" target="_blank"
              >Kassel Code Meetup 21 </a
            >, 27. Juli 2022</small
          >
          <img src="./monopoly-brand.jpg" />
          <h4>Das Spiel um den groÃŸen Deal</h4>
        </section>
        <section>
          <h3>.Me</h3>
          <div class="row">
            <div class="col-7">
              <ul>
                <li><strong>Kai Dorschner</strong> (born in '86)</li>
                <li>Ex-Freelancer 10+ years</li>
                <li>Frontend ðŸ’–</li>
                <li>BJJ Brownbelt</li>
                <li>
                  Contact:
                  <ul>
                    <li>ICQ: 168457769</li>
                    <li>
                      <a href="mailto:kai@aliens-raped.me">kai@aliens-raped.me</a>
                    </li>
                  </ul>
                </li>
              </ul>
            </div>
            <div class="col-5">
              <img src="me.jpg" class="r-frame" />
            </div>
          </div>
          <blockquote>
            <p><q>spaces are better than tabs.</q></p>
          </blockquote>
        </section>
        <section>
          <h1>Disclaimer</h1>
          <h3><span class="text-info">heavily</span> Frontend and Javascript <span class="text-info">biased</span></h3>
          <p class="opacity-50">Also: Ask questions whenever you want</p>
        </section>
        <section>
          <h3>Structure</h3>
          <ol class="fs-4">
            <li>
              <span>What are <strong><span class="text-warning">Poly</span>repos</strong></span>
              <ol class="fragment" data-fragment-index="1">
                <li>Definition</li>
                <li>Use Cases + Demo</li>
                <li>Pros</li>
                <li>Cons</li>
              </ol>
            </li>
            <li>
              <span>What are <strong><span class="text-info">Mono</span>repos</strong></span>
              <ol class="fragment" data-fragment-index="1">
                <li>Definition</li>
                <li>Use Cases + Demo</li>
                <li>Pros</li>
                <li>Cons</li>
              </ol>
            </li>
            <li class="fragment" data-fragment-index="1"><strong><span class="text-info">Mono</span>repos</strong> Pitfalls</li>
            <li class="fragment" data-fragment-index="1">Sources</li>
          </ol>
        </section>
        <section>
          <section>
            <h2 class="fragment semi-fade-out" data-fragment-index="1">
              <span>Mono</span>
              <span class="opacity-50">&middot;</span>
              <span>Oligo</span>
              <span class="opacity-50">&middot;</span>
              <span class="text-warning">Poly</span>
            </h2>
            <h2 class="fragment fade-up" data-fragment-index="1">
              <span>one</span>
              <span class="opacity-50">&middot;</span>
              <span>few</span>
              <span class="opacity-50">&middot;</span>
              <span class="text-warning">many</span>
            </h2>
          </section>

          <section data-auto-animate>
            <h4><span class="text-warning">Poly</span>repos</h4>
            <h1>Definition</h1>
          </section>
          <section
            data-auto-animate
            data-background-image="./uncle-pennybags/beard.png"
            data-background-opacity=".6"
            data-background-position="100% 75%"
            data-background-size="auto 50vh"
          >
            <h4><span class="text-warning">Poly</span>repos</h4>
            <ul>
              <li class="fragment fade-in-then-semi-out"><span class="text-warning">one</span> Problem == <span class="text-warning">one</span> Repo</li>
              <li class="fragment fade-in-then-semi-out">
                <span class="text-warning">one</span> Product == <span class="text-danger">many</span> Repos
              </li>
              <li class="fragment fade-in-then-semi-out">classic, well-understood approach</li>
            </ul>

            <aside class="notes">
              <ul>
                <li><strong>Problem</strong>: Frontend, Backend, Database, Infra</li>
              </ul>
            </aside>
          </section>
          <section data-auto-animate>
            <h4><span class="text-warning">Poly</span>repos</h4>
            <h1>Use Cases</h1>
          </section>
          <section
            data-auto-animate
            data-background-image="./uncle-pennybags/pointing.png"
            data-background-opacity=".6"
            data-background-position="100% 75%"
            data-background-size="auto 50vh"
          >
            <h4><span class="text-warning">Poly</span>repos</h4>
            <ul>
              <li class="fragment fade-in-then-semi-out">heterogeneous teams</li>
              <li class="fragment fade-in-then-semi-out">code isolation</li>
              <li class="fragment fade-in-then-semi-out">code separation</li>
              <li class="fragment fade-in-then-semi-out">dependency-free projects</li>
              <li class="fragment fade-in-then-semi-out">monoliths</li>
            </ul>

            <p class="fragment fade-in-then-semi-out">
              <a href="https://github.com/microsoft/terminal" role="button" target="_blank">terminal Demo</a>
            </p>

            <aside class="notes">
              <ul>
                <li>
                  <strong>heterogeneous teams</strong>: different coding styles, different languages, opposing teams
                  repo structures
                </li>
                <li><strong>code isolation</strong>: different SCMs Github vs Gitlab, Open Source vs. Closed Source</li>
                <li><strong>code separation</strong> Frontend, Backend, Infra</li>
              </ul>
            </aside>
          </section>
          <section data-auto-animate>
            <h4><span class="text-warning">Poly</span>repos</h4>
            <h1>Pros</h1>
          </section>
          <section
            data-auto-animate
            data-background-image="./uncle-pennybags/thumbs-up.png"
            data-background-opacity=".6"
            data-background-position="100% 75%"
            data-background-size="auto 50vh"
          >
            <h4><span class="text-warning">Poly</span>repos</h4>
            <ul>
              <li class="fragment fade-in-then-semi-out">encapsulated code base</li>
              <li class="fragment fade-in-then-semi-out">granular access control</li>
            </ul>

            <aside class="notes">
              <ul>
                <li>
                  <strong>granular access control</strong>: e.g. grant external users access to only one part of your
                  application
                </li>
              </ul>
            </aside>
          </section>
          <section data-auto-animate>
            <h4><span class="text-warning">Poly</span>repos</h4>
            <h1>Cons</h1>
          </section>
          <section
            data-auto-animate
            data-background-image="./uncle-pennybags/warn.png"
            data-background-opacity=".6"
            data-background-position="100% 75%"
            data-background-size="auto 50vh"
          >
            <h4><span class="text-warning">Poly</span>repos</h4>
            <ul>
              <li class="fragment fade-in-then-semi-out">Sync dependency versions</li>
              <li class="fragment fade-in-then-semi-out">Sync API changes</li>
              <li class="fragment fade-in-then-semi-out">establish Coding Standards</li>
              <li class="fragment fade-in-then-semi-out">Code Duplication</li>
            </ul>

            <aside class="notes">
              <ul>
                <li><strong>Code Duplication</strong>: node_modules, linting rules</li>
              </ul>
            </aside>
          </section>
        </section>
        <section>
          <section>
            <h2 class="fragment semi-fade-out" data-fragment-index="1">
              <span class="text-info">Mono</span>
              <span class="opacity-50">&middot;</span>
              <span>Oligo</span>
              <span class="opacity-50">&middot;</span>
              <span>Poly</span>
            </h2>
            <h2 class="fragment fade-up" data-fragment-index="1">
              <span class="text-info">one</span>
              <span class="opacity-50">&middot;</span>
              <span>few</span>
              <span class="opacity-50">&middot;</span>
              <span>many</span>
            </h2>
          </section>
          <section data-auto-animate>
            <h4><span class="text-info">Mono</span>repos</h4>
            <h1>Definition</h1>
          </section>
          <section
            data-auto-animate
            data-background-image="./uncle-pennybags/beard.png"
            data-background-opacity=".6"
            data-background-position="100% 75%"
            data-background-size="auto 50vh"
          >
            <h4><span class="text-info">Mono</span>repos</h4>
            <ul>
              <li class="fragment fade-in-then-semi-out"><span class="text-info">one</span> Problem == <span class="text-info">one</span> Workspace</li>
              <li class="fragment fade-in-then-semi-out"><span class="text-success">many</span> Problems == <span class="text-info">one</span> Repo</li>
              <li class="fragment fade-in-then-semi-out">
                <span class="text-success">many</span> Products == <span class="text-info">one</span> Repo
              </li>
              <li class="fragment fade-in-then-semi-out">monorepo != monolith</li>
              <li class="fragment fade-in-then-semi-out">relatively* new approach</li>
            </ul>
            <aside class="notes">
              <ul>
                <li>aka: shared codebases</li>
                <li>
                  monorepo: contains many individual, homogeneous (sometimes interdependent) applications (e.g.
                  microservices)
                </li>
                <li>monolith: distills many code fragments into one big application (e.g. a videogame)</li>
                <li>
                  *since early 2000s<sup><a href="https://en.wikipedia.org/wiki/Monorepo" target="_blank">1</a></sup>
                </li>
              </ul>
            </aside>
          </section>
          <section data-auto-animate>
            <h4><span class="text-info">Mono</span>repos</h4>
            <h1>Use Cases</h1>
          </section>
          <section
            data-auto-animate
            data-background-image="./uncle-pennybags/pointing.png"
            data-background-opacity=".6"
            data-background-position="100% 75%"
            data-background-size="auto 50vh"
          >
            <h4><span class="text-info">Mono</span>repos</h4>
            <ul>
              <li class="fragment fade-in-then-semi-out">homogeneous teams</li>
              <li class="fragment fade-in-then-semi-out"><abbr title="Don't repeat yourself">DRY</abbr> principle</li>
              <li class="fragment fade-in-then-semi-out">holistic approach</li>
              <li class="fragment fade-in-then-semi-out">centralized company standards</li>
              <li class="fragment fade-in-then-semi-out">Workspaces</li>
            </ul>

            <p class="fragment fade-in-then-semi-out">
              <a href="https://github.com/facebook/react" role="button" target="_blank">react Demo</a>,
              <a href="https://github.com/lookmom/nohands" role="button" target="_blank">nohands Demo</a>
            </p>

            <aside class="notes">
              <ul>
                <li>
                  <strong>homogeneous</strong>: Share rules/coding-styles
                  <ul>
                    <li>.editorconfig</li>
                    <li>linting</li>
                    <li>prettier</li>
                    <li>tsconfig</li>
                    <li>Test Setup</li>
                  </ul>
                </li>
                <li><strong>DRY</strong>: don't repeat yourself, write once use everywhere</li>
                <li><strong>holistic</strong>: get everything you need with every dependency traceable</li>
                <li><strong>standards</strong>: Corporate Design, API-Interfaces, CI/CD Pipelines, Git Hooks</li>
              </ul>
            </aside>
          </section>
          <section data-auto-animate>
            <h4><span class="text-info">Mono</span>repos</h4>
            <h1>Pros</h1>
          </section>
          <section
            data-auto-animate
            data-background-image="./uncle-pennybags/thumbs-up.png"
            data-background-opacity=".6"
            data-background-position="100% 75%"
            data-background-size="auto 50vh"
          >
            <h4><span class="text-info">Mono</span>repos</h4>
            <ul>
              <li class="fragment fade-in-then-semi-out">Separation of concerns</li>
              <li class="fragment fade-in-then-semi-out">Setup Sharing</li>
              <li class="fragment fade-in-then-semi-out">Interface Sharing (API-Contracts)</li>
              <li class="fragment fade-in-then-semi-out">holistic deployments</li>
              <li class="fragment fade-in-then-semi-out">workspaces are symlinked in <code>node_modules</code></li>
              <li class="fragment fade-in-then-semi-out">absolute import paths</li>
              <li class="fragment fade-in-then-semi-out">synced <code>npm outdated</code> and <code>update</code></li>
              <li class="fragment fade-in-then-semi-out"><span class="text-info">one</span> feature branch per ticket</li>
            </ul>

            <aside class="notes">
              <ul>
                <li><strong>Separation of concerns</strong>: separating a program into distinct sections: assets, models, components, utils, etc.</li>
                <li><strong>Setup Sharing</strong>: consistent test environment, linting rules, coding styles, CI/CD pipelines</li>
              </ul>
            </aside>
          </section>
          <section data-auto-animate>
            <h4><span class="text-info">Mono</span>repos</h4>
            <h1>Cons</h1>
          </section>
          <section
            data-auto-animate
            data-background-image="./uncle-pennybags/warn.png"
            data-background-opacity=".6"
            data-background-position="100% 75%"
            data-background-size="auto 50vh"
          >
            <h4><span class="text-info">Mono</span>repos</h4>
            <ul>
              <li class="fragment fade-in-then-semi-out">More frequent commits
                <ul>
                  <li>CI/CD triggers</li>
                  <li>redeploys</li>
                  <li>costs</li>
                  <li>pulls</li>
                  <li>merge conflicts</li>
                </ul>
              </li>
              <li class="fragment fade-in-then-semi-out">bigger repo size</li>
              <li class="fragment fade-in-then-semi-out">Loose Access Management</li>
            </ul>

            <aside class="notes">
              <ul>
                <li>
                  <strong>partial clones</strong> and
                  <a
                    href="https://github.blog/2020-01-17-bring-your-monorepo-down-to-size-with-sparse-checkout/"
                    target="_blank"
                    >git sparse-checkout</a
                  >
                </li>
              </ul>
            </aside>
          </section>
        </section>
        <section>
          <h2><span class="text-info">Mono</span>repo Pitfalls</h2>
          <ul>
            <li class="fragment fade-up"><strong class="text-danger">version conflicts</strong> may be a <abbr title="pain in the ass">PITA</abbr> to resolve
              <ul>
                <li class="fragment fade-up">example:
                  <ul>
                    <li><code>workspace-a: react ^17.0.2</code></li>
                    <li><code>workspace-b: react >=18.2.0</code>
                      <ul>
                        <li><code>react-select: react ~16.0.0</code>
                      </ul>
                    </li>
                    <li><code>workspace-c: react >=18.2.0</code></li>
                  </ul>
                </li>
                <li class="fragment fade-up">might need <a href="https://docs.npmjs.com/cli/v8/configuring-npm/package-json#overrides" target="_blank">npm overrides</a></li>
              </ul>
            </li>
            <li class="fragment fade-up"><strong class="text-danger">wrong workspace versions</strong> will either fail <u>early</u> or <u>never</u></span></li>
          </ul>

          <aside class="notes">
            <ul>
              <li><strong>wrong workspace version</strong>: if the given version doesn't match your local workspace npm will try to look in the online registry and install that version, which might give unexpected and very nasty to find side-effects.</li>
              <li><strong>Pro Tip</strong>: use <code>@scoped</code> workspace names</li>
            </ul>
          </aside>
        </section>
        <section data-background-color="white" data-background-image="./uncle-pennybags/beard.png"
        data-background-opacity=".6"
        data-background-position="100% 75%"
        data-background-size="auto 100vh">
          <h1>That's it.</h1>
          <p class="fragment fade-up">Questions?</p>
        </section>
        <section data-background-color="white">
          <h2>Sources</h2>
          <ul class="fs-6">
            <li>
              <a href="https://docs.npmjs.com/cli/v8/using-npm/workspaces" target="_blank"
                >https://docs.npmjs.com/cli/v8/using-npm/workspaces</a
              >
            </li>
            <li>
              <a href="https://classic.yarnpkg.com/blog/2017/08/02/introducing-workspaces/" target="_blank"
                >https://classic.yarnpkg.com/blog/2017/08/02/introducing-workspaces/</a
              >
            </li>
            <li>
              <a href="https://en.wikipedia.org/wiki/Monorepo target="_blank"
                >https://en.wikipedia.org/wiki/Monorepo</a
              >
            </li>
            <li><a href="https://github.com/babel/babel" target="_blank">https://github.com/babel/babel</a></li>
            <li>
              <a href="https://www.youtube.com/watch?v=PvabBs_utr8&t=984s" target="_blank"
                >https://www.youtube.com/watch?v=PvabBs_utr8&t=984s</a
              >
            </li>
            <li>
              <a href="https://earthly.dev/blog/monorepo-vs-polyrepo/" target="_blank"
                >https://earthly.dev/blog/monorepo-vs-polyrepo/</a
              >
            </li>
            <li>
              <a
                href="https://github.blog/2020-01-17-bring-your-monorepo-down-to-size-with-sparse-checkout/"
                target="_blank"
                >https://github.blog/2020-01-17-bring-your-monorepo-down-to-size-with-sparse-checkout/</a
              >
            </li>
          </ul>
        </section>
      </div>
    </div>

    <script src="index.js" type="module"></script>
  </body>
</html>
